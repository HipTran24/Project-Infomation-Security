<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Register</title>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.min.js" integrity="sha384-7qAoOXltbVP82dhxHAUje59V5r2YsVfBafyUDxEdApLPmcdhBPg1DKg1ERo0BZlK" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">


<body class="register-page">
    <div class="register-card">
    <div class="text-center mb-3">
      <!-- Logo -->
      <img src="image/techshop.png" alt="áº¢nh logo" class="logo mb-2">
      <h3>Táº¡o tÃ i khoáº£n</h3>
      <p class="text-muted">Báº¡n Ä‘Ã£ cÃ³ tÃ i khoáº£n? <a href="login.html">ÄÄƒng nháº­p táº¡i Ä‘Ã¢y</a></p>
    </div>

    <form>
      <div class="mb-3">
        <label class="form-label">TÃªn Ä‘Äƒng nháº­p</label>
        <input type="text" id="username" class="form-control" placeholder="Nháº­p tÃªn Ä‘Äƒng nháº­p">
        <div id="usernameError" class="text-danger mt-1" style="display:none; font-size:0.9rem;"></div>
      </div>

      <div class="mb-3">
        <label class="form-label">Email</label>
        <input type="email" id="email" class="form-control" placeholder="Nháº­p email">
        <div id="emailError" class="text-danger mt-1" style="display:none; font-size:0.9rem;"></div>
      </div>

      <div class="mb-3 d-flex gap-2">
        <select class="form-select bg-dark text-light" style="max-width: 40%;">
          <option>Google</option>
          <option>Facebook</option>
          <option>Telegram</option>
        </select>
        <input type="text" class="form-control" placeholder="TÃªn cá»§a báº¡n">
      </div>

      <div class="mb-3">
        <label class="form-label">MÃ¢t kháº©u</label>
        <input type="password" id="password" class="form-control" placeholder="Nháº­p máº­t kháº©u">
      </div>

      <div class="form-check mb-3">
        <input type="checkbox" class="form-check-input" id="terms">
        <label for="terms" class="form-check-label">Äá»“ng Ã½ vá»›i cÃ¡c Ä‘iá»u khoáº£n vÃ  dá»‹ch vá»¥</label>
        <div id="termsError" class="text-danger mt-1" style="display:none; font-size:0.9rem;"></div>
      </div>

      <button type="submit" class="btn-gradient">ÄÄƒng kÃ½</button>
      <div id="successMessage" class="text-success mt-2" style="display:none; font-size:0.95rem;"></div>
    </form>
  </div>

<!--    <script>-->
<!--        const usernameError = document.querySelector("#usernameError");-->
<!--        const emailError = document.querySelector("#emailError");-->
<!--        const termsError = document.querySelector("#termsError");-->
<!--        const successMessage = document.querySelector("#successMessage");-->

<!--        document.querySelector("form").addEventListener("submit", function(event) {-->
<!--        event.preventDefault();-->

<!--        // áº¨n táº¥t cáº£ thÃ´ng bÃ¡o trÆ°á»›c-->
<!--        usernameError.style.display = emailError.style.display = termsError.style.display = successMessage.style.display = "none";-->

<!--        // Kiá»ƒm tra checkbox-->
<!--        if (!document.querySelector("#terms").checked) {-->
<!--            termsError.textContent = "Báº¡n pháº£i Ä‘á»“ng Ã½ vá»›i cÃ¡c Ä‘iá»u khoáº£n Ä‘á»ƒ Ä‘Äƒng kÃ½!";-->
<!--            termsError.style.display = "block";-->
<!--            return;-->
<!--        }-->

<!--          const data = {-->
<!--              username: document.querySelector("input[placeholder='Nháº­p tÃªn Ä‘Äƒng nháº­p']").value,-->
<!--              email: document.querySelector("input[placeholder='Nháº­p email']").value,-->
<!--              password: document.querySelector("input[placeholder='Nháº­p máº­t kháº©u']").value-->
<!--          };-->

<!--          fetch("http://localhost:8080/mywed/user/register", {-->
<!--              method: "POST",-->
<!--              headers: { "Content-Type": "application/json" },-->
<!--              body: JSON.stringify(data)-->
<!--          })-->
<!--        .then(res => res.text()) // Service tráº£ vá» String-->
<!--        .then(message => {-->
<!--            if(message.includes("thÃ nh cÃ´ng")) {-->
<!--                successMessage.textContent = message;-->
<!--                successMessage.style.display = "block";-->
<!--                setTimeout(() => {-->
<!--                    // Chuyá»ƒn qua trang nháº­p OTP-->
<!--                    window.location.href = "verify-otp.html?email=" + encodeURIComponent(data.email);-->
<!--                }, 1200);-->
<!--            } else if(message.includes("TÃªn Ä‘Äƒng nháº­p")) {-->
<!--                usernameError.textContent = message;-->
<!--                usernameError.style.display = "block";-->
<!--            } else if(message.includes("Email")) {-->
<!--                emailError.textContent = message;-->
<!--                emailError.style.display = "block";-->
<!--            } else {-->
<!--                // Náº¿u lá»—i khÃ¡c-->
<!--                successMessage.textContent = message;-->
<!--                successMessage.style.display = "block";-->
<!--            }-->
<!--        })-->
<!--        .catch(err => console.error(err));-->
<!--        });-->

<!--        // áº¨n lá»—i checkbox khi tick-->
<!--        document.querySelector("#terms").addEventListener("change", function() {-->
<!--        if (this.checked) termsError.style.display = "none";-->
<!--        });-->

<!--</script>-->
    <script>
        const usernameError = document.querySelector("#usernameError");
        const emailError = document.querySelector("#emailError");
        const termsError = document.querySelector("#termsError");
        const successMessage = document.querySelector("#successMessage");

        document.querySelector("form").addEventListener("submit", function(event) {
            event.preventDefault();

            // áº¨n táº¥t cáº£ thÃ´ng bÃ¡o trÆ°á»›c
            usernameError.style.display = "none";
            emailError.style.display = "none";
            termsError.style.display = "none";
            successMessage.style.display = "none";

            // Kiá»ƒm tra checkbox
            if (!document.querySelector("#terms").checked) {
                termsError.textContent = "Báº¡n pháº£i Ä‘á»“ng Ã½ vá»›i cÃ¡c Ä‘iá»u khoáº£n Ä‘á»ƒ Ä‘Äƒng kÃ½!";
                termsError.style.display = "block";
                return;
            }

            const data = {
                username: document.querySelector("#username").value,
                email: document.querySelector("#email").value,
                password: document.querySelector("#password").value
            };

            fetch("http://localhost:8080/mywed/user/register", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(data)
            })
                .then(res => res.text()) // Service tráº£ vá» String
                .then(message => {
                    const msg = message.toLowerCase();

                    // ğŸ”¹ 1) ÄÃƒ ÄÄ‚NG KÃ NHÆ¯NG CHÆ¯A XÃC THá»°C â†’ NHáº¢Y THáº²NG SANG TRANG OTP
                    if (
                        msg.includes("chÆ°a xÃ¡c thá»±c") ||
                        msg.includes("chua xac thuc") ||
                        msg.includes("chÆ°a xÃ¡c minh") ||
                        msg.includes("otp má»›i Ä‘Ã£ Ä‘Æ°á»£c gá»­i")
                    ) {
                        // KhÃ´ng hiá»‡n lá»—i gÃ¬, chuyá»ƒn tháº³ng sang verify-otp
                        window.location.href =
                            "verify-otp.html?email=" + encodeURIComponent(data.email);
                        return;
                    }

                    // ğŸ”¹ 2) ÄÄ‚NG KÃ Má»šI THÃ€NH CÃ”NG
                    if (msg.includes("thÃ nh cÃ´ng")) {
                        successMessage.textContent = message;
                        successMessage.classList.remove("text-danger");
                        successMessage.classList.add("text-success");
                        successMessage.style.display = "block";

                        setTimeout(() => {
                            window.location.href =
                                "verify-otp.html?email=" + encodeURIComponent(data.email);
                        }, 1200);

                        // ğŸ”¹ 3) TÃŠN ÄÄ‚NG NHáº¬P ÄÃƒ Tá»’N Táº I
                    } else if (msg.includes("tÃªn Ä‘Äƒng nháº­p") && msg.includes("tá»“n táº¡i")) {
                        usernameError.textContent = message;
                        usernameError.style.display = "block";

                        // ğŸ”¹ 4) EMAIL ÄÃƒ Tá»’N Táº I (Ä‘Ã£ xÃ¡c thá»±c rá»“i)
                    } else if (msg.includes("email") && msg.includes("tá»“n táº¡i")) {
                        emailError.textContent = message;
                        emailError.style.display = "block";

                        // ğŸ”¹ 5) CÃC Lá»–I KHÃC
                    } else {
                        successMessage.textContent = message;
                        successMessage.classList.remove("text-success");
                        successMessage.classList.add("text-danger");
                        successMessage.style.display = "block";
                    }
                })
                .catch(err => console.error(err));
        });

        // áº¨n lá»—i checkbox khi tick
        document.querySelector("#terms").addEventListener("change", function() {
            if (this.checked) termsError.style.display = "none";
        });
    </script>


</body>